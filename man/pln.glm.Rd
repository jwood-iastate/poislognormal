% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plnGlm.R
\name{pln.glm}
\alias{pln.glm}
\title{Fit a Poisson-Lognormal Regression Model}
\usage{
pln.glm(
  formula,
  data,
  offset = NULL,
  weights = NULL,
  method = "NM",
  verbose = FALSE,
  ...
)
}
\arguments{
\item{formula}{A formula specifying the model.}

\item{data}{A data frame containing the variables in the model.}

\item{offset}{An optional character string specifying an offset variable in 
`data`.}

\item{weights}{An optional character string specifying a weights variable in 
`data`.}

\item{method}{A character string specifying the optimization method for 
`maxLik`. See `?maxLik::maxLik` for options.}

\item{verbose}{A logical value. If `TRUE`, detailed optimization output is 
printed.}

\item{...}{Additional arguments passed to `maxLik::maxLik` (e.g., `iterlim`).}
}
\value{
An object of class `poislogn_fit`.
}
\description{
Fits a Poisson-Lognormal regression model using direct maximum likelihood
estimation via the `maxLik` package.
}
\details{
This function directly optimizes the Poisson-Lognormal log-likelihood 
function to estimate both the regression coefficients (betas) and the 
dispersion parameter (`sigma`) simultaneously. This provides a direct 
estimate and standard error for `sigma`.

The `sigma` parameter is estimated on the log scale (`log(sigma)`) to ensure
it remains positive during optimization. The returned estimate and standard
error are transformed back to the original scale.
}
\examples{
## --- Example with washington_roads dataset ---
data(washington_roads)

# Fit a model for total crashes
# The offset term must be on the log scale.
pln_model_roads <- pln.glm(
  Total_crashes ~ lnaadt  + lnlength,
  data = washington_roads
)

# View the model summary
summary(pln_model_roads)

predict(pln_model_roads, type = "response", newdata = washington_roads)

}
