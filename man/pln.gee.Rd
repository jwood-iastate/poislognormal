% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pln_gee.R
\name{pln.gee}
\alias{pln.gee}
\title{Fit a Poisson-Lognormal GEE Model (Fixed Sigma)}
\usage{
pln.gee(formula, id, data, sigma, corstr = "independence", ...)
}
\arguments{
\item{formula}{A formula specifying the model.}

\item{id}{A vector that identifies the clusters.}

\item{data}{A data frame containing the variables.}

\item{sigma}{A single, positive numeric value for the fixed dispersion parameter.}

\item{corstr}{A character string specifying the correlation structure. See
`?geeM::geem` for options (e.g., "independence", "exchangeable", "ar1").}

\item{...}{Additional arguments passed to `geeM::geem`.}
}
\value{
An object of class `pln_gee`, which inherits from `geem`.
}
\description{
Fits a Poisson-Lognormal model for correlated count data using Generalized
Estimating Equations (GEE). This version requires a fixed, known sigma.
}
\details{
This function acts as a wrapper around `geeM::geem` to fit a GEE model
with a custom variance function for the Poisson-Lognormal distribution.

The variance function is defined as:
\deqn{Var(Y) = \mu + (e^{\sigma^2}-1) \mu^2}

The dispersion parameter `sigma` is **not** estimated by this function.
It must be provided as a fixed, known value. For iterative estimation of
sigma, see `pln.gee.est`.
}
\note{
Using `pln.gee` requires specifying the value of `sigma`.
}
\examples{
## --- Example with washington_roads dataset ---
data(washington_roads)
# Create a binary indicator for high AADT
washington_roads$AADTover10k <- ifelse(washington_roads$AADT > 10000, 1, 0)

# Fit a model for Total crashes
# Note: We now pass the ID column directly, which is best practice.
total_crash_model <- pln.gee(Total_crashes ~ lnaadt + speed50 +
 ShouldWidth04 + AADTover10k + lnlength,
  sigma = 0.5,
  id = ID, 
  data = washington_roads
  )

summary(total_crash_model)

}
