% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pln_gee.R
\name{pln.gee.est}
\alias{pln.gee.est}
\title{Fit a Poisson-Lognormal GEE Model with Iterative Sigma Estimation}
\usage{
pln.gee.est(
  formula,
  id,
  data,
  corstr = "independence",
  tol = 1e-04,
  max_iter = 50,
  ...
)
}
\arguments{
\item{formula}{A formula specifying the model.}

\item{id}{A character string specifying the name of the cluster/subject ID column.}

\item{data}{A data frame containing the variables.}

\item{corstr}{A character string specifying the correlation structure.}

\item{tol}{Tolerance for convergence of `sigma`.}

\item{max_iter}{Maximum number of iterations.}

\item{...}{Additional arguments passed to `geeM::geem`.}
}
\value{
An object of class `pln_gee`, which inherits from `geem`, with the
  estimated `sigma` included.
}
\description{
Fits a Poisson-Lognormal GEE model and iteratively estimates the dispersion
parameter `sigma` using the method of moments.
}
\details{
This function provides a convenient wrapper that automates the estimation of
the dispersion parameter `sigma`. It uses an iterative algorithm that
alternates between:
1. Fitting the GEE model with a fixed `sigma` to estimate coefficients.
2. Using the Pearson residuals from the fit to find an updated `sigma` that
   satisfies the moment condition (i.e., sum of squared Pearson residuals
   equals the residual degrees of freedom).

This process repeats until `sigma` converges.
}
\examples{
## --- Example with washington_roads dataset ---
data(washington_roads)

# Create a binary indicator for high AADT
washington_roads$AADTover10k <- ifelse(washington_roads$AADT > 10000, 1, 0)

# Fit a model for animal-related crashes, using road length as an exposure offset
# The offset term must be on the log scale.
gee_model_est <- pln.gee.est(
  formula = Animal ~ lnaadt + speed50 + ShouldWidth04 + AADTover10k + offset(lnlength),
  id = "ID",
  data = washington_roads,
  corstr = "exchangeable"
)

# View the summary
summary(gee_model_est)
}
